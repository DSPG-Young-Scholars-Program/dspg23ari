---
title: "06_06_2023_ExtractingData02"
output: pdf_document
date: "2023-06-06"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(pdftools)
library(tesseract)
library(stringr)
library(rlist)
```

```{r}
#reading pdf
data <- pdf_data("./data/2021_PAM_600-3_ADA.pdf")
```

```{r}
# MOS

# extracting page 1
page1data <- data[[1]]

# making a character vector of all our words
page1textsep <- as.character(page1data$text)

# getting text of page 1
page1text <- paste(page1textsep, collapse = " ")

# getting MOS
MOS <- str_extract(page1text, pattern = "^.*?(?=\\h\\d)")
```

```{r}
# trying things on a small chunk of the pdf

# extracting page 4
page4data <- data[[4]]

# making a character vector of all our words
page4textsep <- as.character(page4data$text)

# getting the full text
page4text <- paste(page4textsep, collapse = " ")

# make a regex for stuff we want to extract
pattern1 <- "(\\h[a-z]\\.\\h).*?(?=\\h[a-z]\\.\\h)|(\\h[a-z]\\.\\h).*?(?=$)"

# make an example to test a regex on
example <- "text. e. some text here. f. some more text. g. final text"

# does it work? yep :)
str_extract_all(example, pattern1)

# try on page 4
str_extract_all(page4text, pattern = pattern1)
```


```{r}
# moving to larger chunks

# let's make a bigger string
pages4to7data <- list.rbind(data[4:7])
pages4to7sep <- as.character(pages4to7data$text)
fulltext <- paste(pages4to7sep, collapse = " ")

# try extraction...works :) 
sections <- str_extract_all(fulltext, pattern = pattern1)

# get it out of list
info <- unlist(sections[[1]])
```

```{r}
# extract rank

# create empty vector
ranks <- character()

# for loop to add rank to vector
for (i in info) {
  ranks <- str_extract(info, pattern = "(?<=\\h[a-z]\\.\\h).*?(?=\\h)")
}
info[1]
info[2]
```

```{r}
#start paring down to assignments

#empty character vector
assignmentparagraphs <- character()

for(i in info) {
  assignmentparagraphs <- str_extract_all(info, pattern = "(\\(2\\).*(?=\\(3\\)))|(\\(3\\).*(?=\\(4\\)))")
}
paragraphs <- unlist(assignmentparagraphs)

```


what is the relationship between average household size and average home price
relationship between average household age and home price
